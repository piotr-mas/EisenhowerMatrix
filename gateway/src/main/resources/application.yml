spring:
  application:
    name: Gateway
  cloud:
    gateway:
      server:
        webflux:
          routes:
            - id: user-service
              uri: https://user-service-host:8081
              predicates:
                - name: Path
                  args:
                    pattern: /user/**
              filters:
                - name: RequestHeaderToRequestUri
                  args:
                    name: X-Forwarded-Host
                    regexp: .*

server:
  port: 8080
  # Enable SSL
  ssl:
    # Client Keystore - contains gateway's certificate
    key-store: classpath:ssl/gateway-keystore.p12
    key-store-password: changeit
    key-store-type: PKCS12
    # Truststore - contains CA cert to trust UserService
    trust-store: classpath:ssl/gateway-truststore.jks
    trust-store-password: changeit
    trust-store-type: JKS
    # Enforce client authentication - mTLS
    client-auth: need

# Externalize the JWT Secret. For production use environment variables or a secrets manager
jwt:
  secret: YV92ZXJ5X3NlY3VyZV9zZWNyZXRfa2V5X29mXzMyX2J5dGVzX29yX21vcmU=
# Logging configuration
logging:
  level:
    org:
      springframework:
        cloud:
          gateway: DEBUG